@import "tailwindcss";

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  --font-mono: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  background: #f8fafc; /* bg-slate-50 */
  color: var(--foreground);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom utility classes */
@layer components {
  .card {
    @apply rounded-xl border bg-white shadow-sm p-4;
  }

  .toolbar {
    @apply flex items-center gap-2;
  }
}

/* Prevent drag-and-drop blocking CSS resets */
@layer base {
  * {
    /* Ensure drag events work properly */
    -webkit-user-select: auto;
    -moz-user-select: auto;
    user-select: auto;

    /* Allow touch events for mobile drag */
    touch-action: auto;

    /* Ensure pointer events work */
    pointer-events: auto;
  }

  html,
  body {
    height: 100%;
    margin: 0;
    padding: 0;
    /* Prevent text selection during drag operations */
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }

  /* Allow text selection in inputs and contenteditable */
  input,
  textarea,
  [contenteditable="true"] {
    -webkit-user-select: text;
    -moz-user-select: text;
    user-select: text;
  }
}

/* GrapesJS specific fixes */
@layer components {
  /* Ensure GrapesJS containers have proper sizing */
  .gjs-editor {
    height: 100vh !important;
    width: 100% !important;
    position: relative !important;
    overflow: visible !important;
  }

  /* Fix canvas container */
  .gjs-cv-canvas {
    background: #f8f9fa !important;
    position: relative !important;
    overflow: auto !important;
    pointer-events: auto !important;
  }

  /* Ensure blocks are draggable */
  .gjs-block {
    cursor: grab !important;
    pointer-events: auto !important;
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    user-select: none !important;
    touch-action: manipulation !important;
  }

  .gjs-block:active {
    cursor: grabbing !important;
  }

  /* Fix drag indicators */
  .gjs-dashed {
    outline: 2px dashed #4299e1 !important;
    outline-offset: -2px !important;
    pointer-events: none !important;
  }

  /* Ensure sidebar doesn't block canvas */
  .gjs-pn-panels {
    z-index: 10 !important;
    pointer-events: auto !important;
  }

  /* Fix blocks panel */
  .gjs-blocks-c {
    overflow-y: auto !important;
    max-height: calc(100vh - 100px) !important;
  }

  /* Better visual feedback */
  .gjs-selected {
    outline: 2px solid #4299e1 !important;
    outline-offset: -2px !important;
  }

  .gjs-selected-parent {
    outline: 1px solid #4299e1 !important;
    outline-offset: -1px !important;
    opacity: 0.7 !important;
  }

  /* Ensure no overlays block drag events */
  .gjs-toolbar,
  .gjs-toolbar-item {
    pointer-events: auto !important;
    z-index: 1000 !important;
  }

  /* Fix component hover states */
  .gjs-comp-selected {
    pointer-events: auto !important;
  }

  /* Ensure drag placeholder works */
  .gjs-drag-helper {
    pointer-events: none !important;
    z-index: 9999 !important;
  }
}

/* Utilities for drag-and-drop */
@layer utilities {
  .drag-enabled {
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
    touch-action: manipulation;
    cursor: grab;
  }

  .drag-enabled:active {
    cursor: grabbing;
  }

  .no-pointer-events {
    pointer-events: none;
  }

  .auto-pointer-events {
    pointer-events: auto;
  }

  .full-height {
    height: 100vh;
    min-height: 100vh;
  }
}
